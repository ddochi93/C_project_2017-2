#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#pragma warning(disable: 4996)


void wordQuiz();
void flashCard();
void hangman();
void wordList();
void addFile();
void myflush();

int fileNum = 0 ;

typedef struct word_list{
    char * eng_word;
    char * kor_word[3];
    struct word_list* next;
} word_list;



int main(void)
{
    FILE * fp = NULL;
    char fileHead[100];
    char fileTail[100] = ".dic";
    int output_select;
    char buffer[50];  //단어를 입력받기 위한 배열
    char * point;     //각 줄에 잘라낸 한글,영 단어를 포인트하는 포인터

    char word[20];   //단어 게임시 입력받는 배열

    int i = 0 ;
    int cnt = 0;        //맞힌 단어 갯수

    printf("파일명(일차)\n");
    gets(fileHead);
    strcat(fileHead,fileTail);

    fp = fopen(fileHead,"r");
    if( fp == NULL)
    {
        printf("%s파일이 없습니다!!!\n",fileHead);
        return -1;
    }

    printf("출력방식(알파벳 순서대로 : 1, 무작위 : 2) : ");
    scanf("%d",&output_select);

    if(output_select == 2)
    {
        while( fgets(buffer, 10000, fp) != NULL)
        {
            //fgets는 '\n'도 문자열의 일부로 받으므로 제거하고 NULL문자 삽입하는 는과정
            buffer[ strlen(buffer) -1] = '\0';

            word_list * newNode;
            newNode = (word_list *)malloc( sizeof(word_list));
            //밑에세 줄 : newNode초기화
//          newNode->eng_word = NULL;
//          for(i=0 ; i<3; i++)
//              newNode->kor_word[i] = NULL;
//          newNode ->next = NULL;

            point = strtok(buffer," ");

            newNode ->eng_word = (char*)malloc( sizeof(char) * strlen(point) + 1);
            strcpy(newNode ->eng_word,point);

            point = strtok(NULL," ");
            newNode->kor_word[0] = (char *)malloc( sizeof(char) * strlen(point) +1);
            strcpy(newNode ->kor_word[0],point);

              printf("%s -> ",newNode->kor_word[0]);
              myflush();              //이거 안해주면 첫줄에 china -> incorrect됨. (입력 버퍼 비워준다. - 근데 입력버퍼가 왜차잇지??)
            scanf("%s",word);            //이거 gets(word)로 했을떈 왜 이상했을까?

            i++;                        //단어 넘어갈때마다 i는 증가 (점수계산위함)

            if( strcmp(newNode -> eng_word,word) == 0 )
            {
                printf("correct!\n");
                cnt++;
            }
            else if( strcmp(".quit", word) == 0)
            {
                i--;         //이떄는 i를 올리지 않아야함
              break;
            }
            else

              printf("incorrect!\n");

        }
    }

    printf("당신의 점수는 %.2f 점입니다.\n", (float)cnt/i * 100);
    getchar();

    return 0;
}


void myflush()
{
    while( getchar() != '\n')
        ;
}
